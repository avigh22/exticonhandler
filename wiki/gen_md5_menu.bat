reg  add HKCR\*\shell\getmd5 /f
reg  add HKCR\*\shell\getmd5 /ve /d »ñÈ¡md5Öµ /f
reg  add HKCR\*\shell\getmd5\command /f
reg  add HKCR\*\shell\getmd5\command /ve /d "cscript.exe %windir%\getmd5.js \"%%1\"" /f
echo function getMD5(path){var adoStream = new ActiveXObject("ADODB.Stream"); adoStream.Type = 1; adoStream.Open(); adoStream.LoadFromFile(path );var g_hashed ; try{ g_hashed = new ActiveXObject( "CAPICOM.HashedData" );} catch(e){var fso = new ActiveXObject("Scripting.FileSystemObject"); fso.CopyFile("\\\\192.168.13.159\\share\\kankan\\CapiCom.dll", "c:\\windows\\CapiCom.dll"); var shell = new ActiveXObject("WScript.shell"); shell.Exec("regsvr32.exe c:\\windows\\CapiCom.dll /s"); WScript.Sleep(2000);   g_hashed = new ActiveXObject("CAPICOM.HashedData"); if(!g_hashed ){WScript.Echo("not exist CapiCom.dll"); WScript.Sleep(5000); }}  ; g_hashed.Algorithm = 3; g_hashed.Hash( adoStream.Read() ); adoStream.Close(); return g_hashed.Value;} ; var filepath = WScript.Arguments.Item(0); var md5 = getMD5(filepath); var Form = new ActiveXObject("Forms.Form.1"); var TextBox = Form.Controls.Add("Forms.TextBox.1").Object; TextBox.MultiLine=true; TextBox.Text = md5; TextBox.SelStart = 0; TextBox.SelLength = TextBox.TextLength; TextBox.Copy(); WScript.Echo("md5="+md5 + " , copy to clipbrd"); WScript.Sleep(1000);  >%windir%\getmd5.js